# P02_개발_환경_설정

## 시스템 요구사항

### 기본 환경
- **운영체제**: Windows 10/11 (현재 개발 환경 기준)
- **Python**: 3.13.5
- **데이터베이스**: MySQL 8.4
- **IDE**: Visual Studio Code 권장

### 필수 도구
- Git
- Python 3.13.5
- MySQL 8.4
- Node.js (프론트엔드 개발 시 필요)

## Python 환경 설정

### 가상환경 설정
```bash
# 가상환경이 이미 생성되어 있음 (.venv 폴더)
# 가상환경 활성화 (Windows)
.venv\Scripts\activate

# 가상환경 활성화 (Linux/Mac)
source .venv/bin/activate

# 가상환경 비활성화
deactivate
```

### 패키지 설치
```bash
# 가상환경 활성화 후 실행
pip install -r requirements.txt

# 개별 패키지 설치 예시
pip install openai langchain langchain-community
pip install chromadb
pip install fastapi uvicorn
pip install mysql-connector-python
pip install python-dotenv
```

### 환경 변수 설정
`.env` 파일 생성 (프로젝트 루트):
```env
# OpenAI API
OPENAI_API_KEY=your_openai_api_key_here

# MySQL Database
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_DATABASE=kakaotalk_templates
MYSQL_USER=your_username
MYSQL_PASSWORD=your_password

# Application Settings
APP_ENV=development
API_PORT=8000
LOG_LEVEL=INFO

# Vector Database (Chroma)
CHROMA_PERSIST_DIRECTORY=./chroma_db
```

## 데이터베이스 설정

### MySQL 설치 및 설정
1. MySQL 8.4 설치
2. 데이터베이스 생성:
```sql
CREATE DATABASE kakaotalk_templates CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'app_user'@'localhost' IDENTIFIED BY 'secure_password';
GRANT ALL PRIVILEGES ON kakaotalk_templates.* TO 'app_user'@'localhost';
FLUSH PRIVILEGES;
```

### 테이블 구조 (예상)
```sql
-- 템플릿 저장 테이블
CREATE TABLE templates (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id VARCHAR(255),
    template_name VARCHAR(255),
    content TEXT,
    category VARCHAR(100),
    status ENUM('draft', 'pending', 'approved', 'rejected'),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- 정책 위반 로그 테이블
CREATE TABLE policy_violations (
    id INT PRIMARY KEY AUTO_INCREMENT,
    template_id INT,
    violation_type VARCHAR(255),
    description TEXT,
    severity ENUM('low', 'medium', 'high'),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (template_id) REFERENCES templates(id)
);
```

## 개발 워크플로우

### 일반적인 개발 과정
1. **가상환경 활성화**
   ```bash
   .venv\Scripts\activate  # Windows
   ```

2. **의존성 설치/업데이트**
   ```bash
   pip install -r requirements.txt
   ```

3. **애플리케이션 실행**
   ```bash
   python main.py
   ```

4. **개발 서버 실행** (FastAPI)
   ```bash
   uvicorn main:app --reload --port 8000
   ```

5. **테스트 실행**
   ```bash
   pytest  # 테스트 프레임워크 설정 후
   ```

### Git 워크플로우
```bash
# 새로운 기능 브랜치 생성
git checkout -b feature/template-generator

# 변경사항 커밋
git add .
git commit -m "feat: Add template generator with policy validation"

# 메인 브랜치로 병합
git checkout main
git merge feature/template-generator
```

## IDE 설정 (VS Code)

### 권장 확장프로그램
```json
{
    "recommendations": [
        "ms-python.python",
        "ms-python.pylint",
        "ms-python.black-formatter",
        "ms-vscode.vscode-json",
        "ms-vscode-remote.remote-containers"
    ]
}
```

### VS Code 설정 (.vscode/settings.json)
```json
{
    "python.defaultInterpreterPath": ".venv/Scripts/python.exe",
    "python.linting.enabled": true,
    "python.linting.pylintEnabled": true,
    "python.formatting.provider": "black",
    "python.formatting.blackArgs": ["--line-length", "88"],
    "files.associations": {
        "*.md": "markdown"
    }
}
```

## 문제 해결

### 일반적인 문제들

1. **가상환경 활성화 실패**
   - PowerShell 실행 정책 확인: `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`

2. **패키지 설치 오류**
   - pip 업그레이드: `python -m pip install --upgrade pip`

3. **MySQL 연결 오류**
   - 방화벽 설정 확인
   - MySQL 서비스 실행 상태 확인

4. **OpenAI API 오류**
   - API 키 유효성 확인
   - 사용량 한도 확인

### 로그 확인
- 애플리케이션 로그: `logs/app.log`
- 데이터베이스 로그: MySQL 에러 로그 확인
- Python 에러: 콘솔 출력 확인

## 성능 최적화

### 벡터 데이터베이스 최적화
- Chroma 데이터베이스 인덱싱 설정
- 정책 문서 청킹 크기 조정
- 유사도 검색 임계값 튜닝

### API 응답 최적화
- 캐싱 전략 구현
- 비동기 처리 활용
- 응답 압축 설정